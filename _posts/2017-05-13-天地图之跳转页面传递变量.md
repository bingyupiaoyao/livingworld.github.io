---
layout: post
title: "asp:treeview之数据调用"
date: 2017-05-13
description: "asp:treeview之数据调用"
tag: asp.net
---   

## 今日任务
- [x] get和set的使用，treeview读取数据库。10:35前完成
- [ ] 天地图api替换。10:35开始。
- [ ] treenode中value作为中文时是否可用？必须是纯数字吗？
- [ ] treenode选择调用。

## c# get和set的使用

由于AspxGridView在执行无刷新动作时，服务端仍然需要执行Page_Load事件，从这里也可以看出，AspxGridView的界面无刷新（ajax）动作，并不能缓解服务端的压力。且webform这类控件都有类似的问题。

## load ascx into placeholder
- [Loading Custom User Controls (ASCX) into PlaceHolder using Library?](https://forums.asp.net/t/1488548.aspx?Loading+Custom+User+Controls+ASCX+into+PlaceHolder+using+Library+)
[Control.UniqueID Property](https://msdn.microsoft.com/en-us/library/system.web.ui.control.uniqueid.aspx)

## 转变思路：先实现table 的加载再考虑树形。

table控件可以正常加载。

## if（！IsPostBack）

if(!IsPostBack)表示第一次访问页面时要执行的程序，有点像初始化页面，当你点击了当前页面的一些按钮后，将不会再执行这些程序。

所以第二次操作时，就不加载Page_Load中的了，所以可以放置在button中。

## 暂时能够实现treeview选择值，表格中数值查询，但无法全部选中了，其二，单独添加进行加载依旧不成功。



ICallbackEventHandler 
ICallbackEventHandler可以说是ajax的关键技术，现在可以使用vs2.0的接口，来实现ajax的效果。
refer to:http://www.cnblogs.com/soso/archive/2006/06/08/420687.html
六步使用ICallbackEventHandler实现无刷新回调

##ICallbackEventHandler是什么？

如果你没有使用code-behind，那你也可以在aspx页面顶部加入下面的代码： 
```
    <%@ Implements Interface="System.Web.UI.ICallbackEventHandler" %>
```

还是没有找到合适的方式，只能换一种策略，即page_load中全部加载内容，但是采用移除的方式就能够保障相互间不会干扰。

上述IcalbackEventHandler在page_load中并不出现该问题，但在radiobuttonlist事件中却出现，为什么？

```
    protected void Page_Load(object sender, EventArgs e)
    {
        TreeViewUserControl_example = LoadControl("~/TreeViewUserControl.ascx") as TreeViewUserControl;
        Placeholder1.Controls.Add(TreeViewUserControl_example);
        TreeViewUserControl_example.Visible = false;
        TreeViewUserControl_example2 = LoadControl("~/TreeViewUserControl2.ascx") as TreeViewUserControl2;
        Placeholder1.Controls.Add(TreeViewUserControl_example2);
        TreeViewUserControl_example2.Visible = false;
    }


    protected void RadioButtonList1_SelectedIndexChanged(object sender, EventArgs e)
    {

        if(RadioButtonList1.SelectedValue == "1")
        {

            TreeViewUserControl_example.Visible = true;

            Placeholder1.Controls.Remove(TreeViewUserControl_example2);

        }
        if (RadioButtonList1.SelectedValue == "2")
        {
            TreeViewUserControl_example2.Visible = true;
            Placeholder1.Controls.Remove(TreeViewUserControl_example);
        }
    }

```

